(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[1782],{16825:function(e,r,s){Promise.resolve().then(s.bind(s,88758))},88758:function(e,r,s){"use strict";s.r(r),s.d(r,{default:function(){return b}});var t=s(57437),a=s(2265),l=s(7476),n=s(16463),i=s(87138),o=s(84894),d=s(11444),c=s(44785),u=s(11929),m=s(14595),p=s(66648),x=s(80537);let h=s(38472).Z.create({baseURL:"https://testingbackend.ceramicandfoodproducts.com",withCredentials:!0});h.interceptors.response.use(e=>e,async e=>{var r;console.log("hello interceptors");let s=e.config;if((null===(r=e.response)||void 0===r?void 0:r.status)===401&&!s._retry){s._retry=!0;try{return await h.post("/auth/refresh",{},{withCredentials:!0}),h(s)}catch(e){window.location.href="/login"}}return Promise.reject(e)}),s(30998);let f=x.Ry({email:x.Z_().min(1,"Email is required").email("Invalid email format"),password:x.Z_().min(6,"Password must be at least 6 characters")}),g={inputProps:{"aria-label":"Checkbox demo"}};var b=()=>{let[e,r]=(0,a.useState)(!1),s=(0,n.useRouter)(),x=(0,d.I0)(),{loading:b}=(0,d.v9)(e=>e.user),[w,v]=(0,a.useState)({email:"",password:""}),[j,N]=(0,a.useState)({email:"",password:""}),[y,S]=(0,a.useState)(""),k=e=>{v({...w,[e.target.name]:e.target.value}),N({...j,[e.target.name]:""}),S("")},F=async e=>{var r,t,a,l;e.preventDefault(),S("");let n=f.safeParse(w);if(!n.success){let e=n.error.flatten().fieldErrors;N({email:(null===(r=e.email)||void 0===r?void 0:r[0])||"",password:(null===(t=e.password)||void 0===t?void 0:t[0])||""});return}try{x((0,o.lA)());let e=(await h.post("".concat("https://testingbackend.ceramicandfoodproducts.com","/auth/login"),{username:w.email,password:w.password},{headers:{"Content-Type":"application/json"},withCredentials:!0})).data,r=(null===(a=e.sub)||void 0===a?void 0:a.role)||e.role;if(console.log("Validation data ",r),!1===e.success){x((0,o.fc)(e.message)),(null===(l=e.message)||void 0===l?void 0:l.toLowerCase().includes("invalid"))?N({email:"",password:"Invalid email or password"}):S(e.message||"An unexpected error occurred.");return}c.Z.set("userRole",r,{expires:1/24,secure:!0,sameSite:"Strict"}),c.Z.set("accessToken",e.accessToken,{expires:1/24,secure:!0,sameSite:"Strict",path:"/"}),x((0,o.AP)(e)),"admin"===e.role?s.push("/dashboard"):s.push("/userdashboard")}catch(e){x((0,o.fc)(e.message)),e.response&&401===e.response.status?N({email:"",password:"Invalid email or password"}):S("There was a server error. Please try again.")}};return(0,t.jsxs)("section",{className:"grid lg:grid-cols-2 max-h-screen",children:[(0,t.jsxs)("div",{className:"relative hidden md:block",children:[(0,t.jsx)(p.default,{src:"/img/signin.png",width:600,height:800,alt:"signin image",className:"w-full blur-lg max-h-screen object-cover object-top"}),(0,t.jsx)("div",{className:"absolute md:w-[445px] top-1/2 -translate-y-1/2 left-1/2 -translate-x-1/2",children:(0,t.jsxs)("div",{className:"text-center",children:[(0,t.jsx)("h3",{className:"text-xl font-bold text-white",children:"Sign Up for better experience"}),(0,t.jsx)(i.default,{href:"/signup",className:"block border-2 active:scale-95 hover:border-[#2FB261] hover:text-[#2FB261] border-white text-white text-xl uppercase px-4 py-2 w-full rounded-[10px] mt-6 transition duration-300",children:"Sign Up"})]})})]}),(0,t.jsx)("div",{className:"flex justify-center items-start mt-5",children:(0,t.jsxs)("div",{className:"bg-white p-8 rounded shadow-md",children:[(0,t.jsx)("h2",{className:"text-2xl font-bold mb-6 text-center",children:"Sign In"}),(0,t.jsx)("span",{className:"block text-[#9F9F9F] text-xl text-center mb-6",children:"Please enter your details"}),(0,t.jsx)("div",{className:"border-b mt-6 mb-8 relative border-black",children:(0,t.jsx)(m.Z,{className:"-mt-3 bg-white absolute left-1/2 -translate-x-1/2",children:"OR"})}),(0,t.jsxs)("form",{onSubmit:F,children:[(0,t.jsxs)("div",{className:"mb-4",children:[(0,t.jsx)("input",{type:"text",id:"email",name:"email",value:w.email,onChange:k,placeholder:"Enter your email",className:"w-full p-3 border rounded-md focus:outline-none ".concat(j.email?"border-red-500":"border-[#E8E8F2]")}),j.email&&(0,t.jsx)("p",{className:"text-red-500 text-sm mt-1",children:j.email})]}),(0,t.jsxs)("div",{children:[(0,t.jsxs)("div",{className:"relative",children:[(0,t.jsx)("input",{type:e?"text":"password",id:"password",name:"password",placeholder:"Password",value:w.password,onChange:k,className:"w-full text-base p-3 placeholder-shown:text-sm border rounded-md focus:outline-none ".concat(j.password?"border-red-500":"border-[#E8E8F2]")}),(0,t.jsx)("button",{type:"button",onClick:()=>r(!e),className:"absolute opacity-50 right-3 top-1/2 -translate-y-1/2",children:e||""===w.password?(0,t.jsx)(l.rzC,{className:"text-xl"}):(0,t.jsx)(l.rDJ,{className:"text-xl"})})]}),j.password&&(0,t.jsx)("p",{className:"text-red-500 text-sm mt-1",children:j.password}),y&&(0,t.jsx)("p",{className:"text-red-500 text-sm mt-1",children:y})]}),(0,t.jsxs)("div",{className:"flex justify-between items-center mt-2",children:[(0,t.jsx)(u.Z,{...g,defaultChecked:!0,sx:{color:"#2FB261","&.Mui-checked":{color:"#2FB261"}}}),(0,t.jsx)("span",{children:(0,t.jsx)("small",{children:(0,t.jsx)(i.default,{href:"/forget_password",children:"Forgot Password?"})})})]}),(0,t.jsx)("button",{type:"submit",disabled:b,className:"active:scale-95 bg-[#2FB261] hover:bg-[#248b4c] text-white text-xl uppercase px-4 py-2 w-full rounded-[10px] mt-6 transition duration-300",children:b?"Signing in...":"Sign In"})]}),(0,t.jsx)(i.default,{href:"/signup",children:(0,t.jsxs)("h6",{className:"text-center mt-3 font-bold text-xl",children:["Don't have an account?"," ",(0,t.jsx)("span",{className:"text-[#2FB261]",children:"Sign Up"})]})})]})})]})}},84894:function(e,r,s){"use strict";s.d(r,{AP:function(){return n},Dl:function(){return p},Uw:function(){return u},fc:function(){return l},jp:function(){return m},kv:function(){return c},lA:function(){return a}});let t=(0,s(81904).oM)({name:"user",initialState:{currentUser:null,error:null,loading:!1},reducers:{SignInStart:e=>{e.loading=!0,e.error=null},SignInSuccess:(e,r)=>{e.currentUser=r.payload,e.loading=!1,e.error=null},SignInFailure:(e,r)=>{e.loading=!1,e.error=r.payload},RegisterStart:e=>{e.loading=!0,e.error=null},RegisterSuccess:(e,r)=>{e.currentUser=r.payload,e.loading=!1,e.error=null},RegisterFailure:(e,r)=>{e.loading=!1,e.error=r.payload},UpdateProfileStart:e=>{e.loading=!0,e.error=null},UpdateProfileSuccess:(e,r)=>{e.currentUser={...e.currentUser,...r.payload},e.loading=!1,e.error=null},UpdateProfileFailure:(e,r)=>{e.loading=!1,e.error=r.payload},LogOutUser:(e,r)=>{e.currentUser=null}}}),{SignInStart:a,SignInFailure:l,SignInSuccess:n,RegisterStart:i,RegisterSuccess:o,RegisterFailure:d,UpdateProfileStart:c,UpdateProfileSuccess:u,UpdateProfileFailure:m,LogOutUser:p}=t.actions;r.ZP=t.reducer}},function(e){e.O(0,[9956,4047,8472,9537,8173,1444,1904,7138,4455,9899,2971,7023,1744],function(){return e(e.s=16825)}),_N_E=e.O()}]);