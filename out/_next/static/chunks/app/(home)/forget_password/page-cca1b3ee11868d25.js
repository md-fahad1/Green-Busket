(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[6520],{81929:function(e,t,s){Promise.resolve().then(s.bind(s,89884))},89884:function(e,t,s){"use strict";s.r(t);var r=s(57437),n=s(2265),a=s(38472),i=s(16463),o=s(64379),l=s.n(o);t.default=()=>{let e=(0,i.useRouter)(),[t,s]=(0,n.useState)(""),[o,d]=(0,n.useState)(""),[c,u]=(0,n.useState)(""),[m,h]=(0,n.useState)(""),[x,p]=(0,n.useState)(""),[f,g]=(0,n.useState)(""),[v,b]=(0,n.useState)(!1),[w,y]=(0,n.useState)(!1),[P,j]=(0,n.useState)(!1),[N,S]=(0,n.useState)(!1),[T,O]=(0,n.useState)(!1),[C,k]=(0,n.useState)(null),E=async e=>{var s,r,n;if(e.preventDefault(),h(""),!t.includes("@")){h("Please enter a valid email.");return}try{b(!0);let e=await a.Z.post("".concat("https://testingbackend.ceramicandfoodproducts.com","/EmailOTP/forgetPassword"),{email:t},{headers:{"Content-Type":"application/json"}});"OTP sent successfully"===e.data?(l().fire({icon:"success",title:"OTP Sent",text:"Please check your email!",timer:2e3,showConfirmButton:!1}),S(!0)):l().fire({icon:"error",title:"Failed",text:(null===(s=e.data)||void 0===s?void 0:s.message)||"Failed to send OTP"})}catch(e){console.error("Send OTP error:",e),l().fire({icon:"error",title:"Error",text:(null===(n=e.response)||void 0===n?void 0:null===(r=n.data)||void 0===r?void 0:r.message)||"Something went wrong."})}finally{b(!1)}},F=async()=>{if(p(""),6!==o.length){p("OTP must be 6 digits.");return}try{var e,s,r,n,i,d;y(!0);let c=await a.Z.post("".concat("https://testingbackend.ceramicandfoodproducts.com","/EmailOTP/check"),{email:t,otp:o},{headers:{"Content-Type":"application/json"}});if((null===(s=c.data)||void 0===s?void 0:null===(e=s.message)||void 0===e?void 0:e.message)==="OTP verified successfully"){let e=null===(i=c.data)||void 0===i?void 0:null===(n=i.message)||void 0===n?void 0:null===(r=n.user)||void 0===r?void 0:r.Id;k(e),O(!0),l().fire({icon:"success",title:"OTP Verified",text:"You can now reset your password.",timer:2e3,showConfirmButton:!1})}else l().fire({icon:"error",title:"Invalid OTP",text:(null===(d=c.data)||void 0===d?void 0:d.message)||"Invalid OTP."})}catch(e){console.error("Verify OTP error:",e),l().fire({icon:"error",title:"Verification Failed",text:"Something went wrong while verifying OTP."})}finally{y(!1)}},I=async()=>{if(g(""),c.length<6){g("Password must be at least 6 characters.");return}try{var t,s,r;j(!0);let n=await a.Z.put("".concat("https://testingbackend.ceramicandfoodproducts.com","/User/newPassword/").concat(C),{newPassword:c},{headers:{"Content-Type":"application/json"}});(null===(t=n.data)||void 0===t?void 0:t.success)||(null===(s=n.data)||void 0===s?void 0:s.message)==="Password updated successfully"?l().fire({icon:"success",title:"Password Changed",text:"You can now login with your new password."}).then(()=>{e.push("/signin")}):l().fire({icon:"error",title:"Failed",text:(null===(r=n.data)||void 0===r?void 0:r.message)||"Failed to reset password."})}catch(e){console.error("Password change error:",e),l().fire({icon:"error",title:"Error",text:"Error resetting password."})}finally{j(!1)}};return(0,r.jsx)("section",{className:"min-h-screen flex items-center justify-center bg-gray-100 px-4",children:(0,r.jsxs)("div",{className:"bg-white p-8 rounded shadow-md w-full max-w-md",children:[(0,r.jsx)("h2",{className:"text-2xl font-bold mb-4 text-center",children:"Forgot Password"}),(0,r.jsxs)("form",{onSubmit:E,children:[(0,r.jsx)("input",{type:"email",placeholder:"Enter your email",className:"w-full border px-4 py-2 rounded-md mb-3",value:t,onChange:e=>s(e.target.value)}),m&&(0,r.jsx)("p",{className:"text-red-500 text-sm mb-2",children:m}),(0,r.jsx)("button",{type:"submit",disabled:v,className:"bg-[#2FB261] w-full text-white font-semibold py-2 px-4 rounded-md hover:bg-[#248b4c] transition",children:v?"Sending OTP...":"Send OTP"})]}),N&&!T&&(0,r.jsxs)("div",{className:"mt-6 border-t pt-4",children:[(0,r.jsx)("h3",{className:"text-lg font-semibold mb-2 text-center",children:"Verify OTP"}),(0,r.jsxs)("p",{className:"text-sm text-gray-600 text-center mb-3",children:["Enter the 6-digit code sent to ",(0,r.jsx)("b",{children:t})]}),(0,r.jsx)("input",{type:"text",value:o,onChange:e=>d(e.target.value.replace(/\D/g,"").slice(0,6)),maxLength:6,className:"w-full px-4 py-2 border text-center rounded-md text-xl tracking-widest mb-2",placeholder:"123456"}),x&&(0,r.jsx)("p",{className:"text-red-500 text-sm text-center",children:x}),(0,r.jsx)("div",{className:"flex justify-center mt-4",children:(0,r.jsx)("button",{type:"button",onClick:F,disabled:w,className:"bg-[#2FB261] text-white px-6 py-2 rounded hover:bg-[#248b4c]",children:w?"Verifying...":"Verify OTP"})})]}),T&&(0,r.jsxs)("div",{className:"mt-6 border-t pt-4",children:[(0,r.jsx)("h3",{className:"text-lg font-semibold mb-2 text-center",children:"Set New Password"}),(0,r.jsx)("input",{type:"password",value:c,onChange:e=>u(e.target.value),className:"w-full px-4 py-2 border rounded-md mb-2",placeholder:"Enter new password"}),f&&(0,r.jsx)("p",{className:"text-red-500 text-sm text-center",children:f}),(0,r.jsx)("div",{className:"flex justify-center mt-4",children:(0,r.jsx)("button",{type:"button",onClick:I,disabled:P,className:"bg-[#2FB261] text-white px-6 py-2 rounded hover:bg-[#248b4c]",children:P?"Changing...":"Change Password"})})]})]})})}},16463:function(e,t,s){"use strict";var r=s(71169);s.o(r,"usePathname")&&s.d(t,{usePathname:function(){return r.usePathname}}),s.o(r,"useRouter")&&s.d(t,{useRouter:function(){return r.useRouter}}),s.o(r,"useServerInsertedHTML")&&s.d(t,{useServerInsertedHTML:function(){return r.useServerInsertedHTML}})}},function(e){e.O(0,[9461,8472,2971,7023,1744],function(){return e(e.s=81929)}),_N_E=e.O()}]);